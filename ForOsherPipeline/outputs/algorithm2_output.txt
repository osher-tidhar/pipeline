Algorithm 2 complete