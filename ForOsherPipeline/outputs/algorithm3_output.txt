Algorithm 3 complete