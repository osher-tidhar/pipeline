Algorithm 1 complete