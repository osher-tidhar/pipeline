Algorithm 5 complete